<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName policycamp.org.uk
    DocumentRoot /var/www/policycamp

    # Error page
    ErrorDocument 404 /404.shtml

    # Serve SSI index by default (useful before redirect and for quick tests)
    DirectoryIndex index.shtml index.html

    # Enable SSI on the docroot (additive Options to avoid parent overrides)
    <Directory /var/www/policycamp>
        Options Includes Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        AddOutputFilter INCLUDES .shtml
    </Directory>

    # Allow SSI subrequests to /includes (filesystem)
    <Directory /var/www/policycamp/includes>
        Require all granted
        AllowOverride None
        Options None
    </Directory>

    # Also allow the URL path /includes/* (for virtual includes)
    <Location "/includes/">
        Require all granted
    </Location>

    # Redirect everything to HTTPS
    RewriteEngine On
# Some rewrite rules in this file were disabled on your HTTPS site,
# because they have the potential to create redirection loops.

#     RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [R=301,L]

    ErrorLog ${APACHE_LOG_DIR}/policycamp-error.log
    CustomLog ${APACHE_LOG_DIR}/policycamp-access.log combined

SSLCertificateFile /etc/letsencrypt/live/policycamp.org.uk/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/policycamp.org.uk/privkey.pem
Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
</IfModule>
